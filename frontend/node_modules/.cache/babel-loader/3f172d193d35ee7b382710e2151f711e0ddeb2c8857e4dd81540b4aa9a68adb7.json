{"ast":null,"code":"var _jsxFileName = \"/Users/dauletkaparov/Desktop/MVP2/frontend/src/components/TextbookUpload.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TextbookUpload = ({\n  onUploadSuccess,\n  onUploadError\n}) => {\n  _s();\n  const [file, setFile] = useState(null);\n  const [title, setTitle] = useState('');\n  const [subject, setSubject] = useState('');\n  const [grade, setGrade] = useState('');\n  const [description, setDescription] = useState('');\n  const [uploading, setUploading] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const [error, setError] = useState('');\n  const [success, setSuccess] = useState(false);\n  const API_URL = process.env.REACT_APP_API_URL || 'http://localhost:8003';\n  const handleFileChange = e => {\n    if (e.target.files && e.target.files[0]) {\n      setFile(e.target.files[0]);\n    }\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!file) {\n      setError('Please select a file to upload');\n      return;\n    }\n    const formData = new FormData();\n    formData.append('file', file);\n    formData.append('title', title);\n    formData.append('subject', subject);\n    formData.append('grade', grade);\n    formData.append('description', description);\n    setUploading(true);\n    setError('');\n    setSuccess(false);\n    setUploadProgress(0);\n\n    // Check if we should use mock upload (for development)\n    const adminDevMode = localStorage.getItem('admin-dev-token') === 'true';\n    if (adminDevMode) {\n      // Use mock upload if in development mode\n      console.log('Using mock upload in development mode');\n      await handleMockUpload(e);\n      return;\n    }\n    try {\n      // First, try with authentication\n      const token = localStorage.getItem('token');\n      const response = await axios.post(`${API_URL}/api/textbooks/upload`, formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data',\n          ...(token ? {\n            Authorization: `Bearer ${token}`\n          } : {})\n        },\n        onUploadProgress: progressEvent => {\n          const percentCompleted = Math.round(progressEvent.loaded * 100 / (progressEvent.total || 100));\n          setUploadProgress(percentCompleted);\n        }\n      });\n      console.log('Upload successful:', response.data);\n      setSuccess(true);\n      setFile(null);\n      setTitle('');\n      setSubject('');\n      setGrade('');\n      setDescription('');\n      if (onUploadSuccess) {\n        onUploadSuccess(response.data);\n      }\n    } catch (primaryError) {\n      console.error('Primary upload attempt failed:', primaryError);\n\n      // Fallback to test endpoint if available\n      try {\n        const fallbackResponse = await axios.post(`${API_URL}/api/test/textbooks/upload`, formData, {\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          },\n          onUploadProgress: progressEvent => {\n            const percentCompleted = Math.round(progressEvent.loaded * 100 / (progressEvent.total || 100));\n            setUploadProgress(percentCompleted);\n          }\n        });\n        console.log('Fallback upload successful:', fallbackResponse.data);\n        setSuccess(true);\n        setFile(null);\n        setTitle('');\n        setSubject('');\n        setGrade('');\n        setDescription('');\n        if (onUploadSuccess) {\n          onUploadSuccess(fallbackResponse.data);\n        }\n      } catch (fallbackError) {\n        console.error('All upload attempts failed:', fallbackError);\n\n        // If all real API attempts failed, try the mock upload as last resort\n        console.log('Using mock upload as fallback after API failures');\n        await handleMockUpload(e);\n        return;\n      }\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  // Mock upload for admin user when backend is unavailable\n  const handleMockUpload = async e => {\n    e.preventDefault();\n    if (!file) {\n      setError('Please select a file to upload');\n      return;\n    }\n    setUploading(true);\n    setError('');\n    setSuccess(false);\n\n    // Simulate upload progress\n    for (let i = 0; i <= 100; i += 10) {\n      setUploadProgress(i);\n      await new Promise(resolve => setTimeout(resolve, 200));\n    }\n    const mockResponse = {\n      id: 'mock-textbook-' + Date.now(),\n      title,\n      subject,\n      grade,\n      description,\n      filename: file.name,\n      uploaded_at: new Date().toISOString(),\n      pages_processed: Math.floor(Math.random() * 100) + 20,\n      status: 'processed'\n    };\n    console.log('Mock upload successful:', mockResponse);\n    setSuccess(true);\n    setFile(null);\n    setTitle('');\n    setSubject('');\n    setGrade('');\n    setDescription('');\n    if (onUploadSuccess) {\n      onUploadSuccess(mockResponse);\n    }\n    setUploading(false);\n  };\n\n  // Check if using admin user\n  const isAdminUser = localStorage.getItem('token') === 'admin-dev-token';\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-white shadow overflow-hidden sm:rounded-lg p-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-lg font-medium text-gray-900 mb-4\",\n      children: \"Upload Textbook\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-red-50 border-l-4 border-red-400 p-4 mb-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-shrink-0\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"h-5 w-5 text-red-400\",\n            viewBox: \"0 0 20 20\",\n            fill: \"currentColor\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              fillRule: \"evenodd\",\n              d: \"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\",\n              clipRule: \"evenodd\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 185,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ml-3\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-red-700\",\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 9\n    }, this), success && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-green-50 border-l-4 border-green-400 p-4 mb-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-shrink-0\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"h-5 w-5 text-green-400\",\n            viewBox: \"0 0 20 20\",\n            fill: \"currentColor\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              fillRule: \"evenodd\",\n              d: \"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\",\n              clipRule: \"evenodd\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 200,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ml-3\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-green-700\",\n            children: \"Textbook successfully uploaded and being processed!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: isAdminUser ? handleMockUpload : handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sm:col-span-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"title\",\n            className: \"block text-sm font-medium text-gray-700\",\n            children: \"Title\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-1\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              id: \"title\",\n              value: title,\n              onChange: e => setTitle(e.target.value),\n              required: true,\n              className: \"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 219,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sm:col-span-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"subject\",\n            className: \"block text-sm font-medium text-gray-700\",\n            children: \"Subject\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-1\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              id: \"subject\",\n              value: subject,\n              onChange: e => setSubject(e.target.value),\n              required: true,\n              className: \"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 235,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sm:col-span-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"grade\",\n            className: \"block text-sm font-medium text-gray-700\",\n            children: \"Grade/Level\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-1\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              id: \"grade\",\n              value: grade,\n              onChange: e => setGrade(e.target.value),\n              required: true,\n              className: \"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 251,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sm:col-span-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"description\",\n            className: \"block text-sm font-medium text-gray-700\",\n            children: \"Description\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-1\",\n            children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n              id: \"description\",\n              rows: 3,\n              value: description,\n              onChange: e => setDescription(e.target.value),\n              className: \"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 267,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 266,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sm:col-span-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"file\",\n            className: \"block text-sm font-medium text-gray-700\",\n            children: \"Textbook File (PDF, DOCX, TXT)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-1 text-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                className: \"mx-auto h-12 w-12 text-gray-400\",\n                stroke: \"currentColor\",\n                fill: \"none\",\n                viewBox: \"0 0 48 48\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  d: \"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02\",\n                  strokeWidth: 2,\n                  strokeLinecap: \"round\",\n                  strokeLinejoin: \"round\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 289,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 283,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex text-sm text-gray-600\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"file-upload\",\n                  className: \"relative cursor-pointer bg-white rounded-md font-medium text-primary-600 hover:text-primary-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-primary-500\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"Upload a file\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 301,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    id: \"file-upload\",\n                    name: \"file-upload\",\n                    type: \"file\",\n                    className: \"sr-only\",\n                    accept: \".pdf,.docx,.doc,.txt\",\n                    onChange: handleFileChange\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 302,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 297,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"pl-1\",\n                  children: \"or drag and drop\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 311,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 296,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs text-gray-500\",\n                children: \"PDF, DOCX, or TXT up to 50MB\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 313,\n                columnNumber: 17\n              }, this), file && /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm text-primary-600 mt-2\",\n                children: [\"Selected: \", file.name, \" (\", (file.size / 1024 / 1024).toFixed(2), \" MB)\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 315,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 282,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 9\n      }, this), uploading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative pt-1\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex mb-2 items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-primary-600 bg-primary-200\",\n                children: \"Uploading\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 329,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 328,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-right\",\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-xs font-semibold inline-block text-primary-600\",\n                children: [uploadProgress, \"%\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 334,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 333,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 327,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"overflow-hidden h-2 mb-4 text-xs flex rounded bg-primary-200\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                width: `${uploadProgress}%`\n              },\n              className: \"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-primary-500 transition-all duration-300\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 340,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 339,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"pt-5\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-end\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => {\n              setFile(null);\n              setTitle('');\n              setSubject('');\n              setGrade('');\n              setDescription('');\n              setError('');\n              setSuccess(false);\n            },\n            className: \"bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\",\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 351,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            disabled: uploading,\n            className: `ml-3 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 ${uploading ? 'opacity-70 cursor-not-allowed' : ''}`,\n            children: uploading ? 'Uploading...' : 'Upload'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 366,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 350,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 177,\n    columnNumber: 5\n  }, this);\n};\n_s(TextbookUpload, \"oTC/Ksm8BFKsNgpEbgRcPfSvwl4=\");\n_c = TextbookUpload;\nexport default TextbookUpload;\nvar _c;\n$RefreshReg$(_c, \"TextbookUpload\");","map":{"version":3,"names":["React","useState","axios","jsxDEV","_jsxDEV","TextbookUpload","onUploadSuccess","onUploadError","_s","file","setFile","title","setTitle","subject","setSubject","grade","setGrade","description","setDescription","uploading","setUploading","uploadProgress","setUploadProgress","error","setError","success","setSuccess","API_URL","process","env","REACT_APP_API_URL","handleFileChange","e","target","files","handleSubmit","preventDefault","formData","FormData","append","adminDevMode","localStorage","getItem","console","log","handleMockUpload","token","response","post","headers","Authorization","onUploadProgress","progressEvent","percentCompleted","Math","round","loaded","total","data","primaryError","fallbackResponse","fallbackError","i","Promise","resolve","setTimeout","mockResponse","id","Date","now","filename","name","uploaded_at","toISOString","pages_processed","floor","random","status","isAdminUser","className","children","fileName","_jsxFileName","lineNumber","columnNumber","viewBox","fill","fillRule","d","clipRule","onSubmit","htmlFor","type","value","onChange","required","rows","stroke","strokeWidth","strokeLinecap","strokeLinejoin","accept","size","toFixed","style","width","onClick","disabled","_c","$RefreshReg$"],"sources":["/Users/dauletkaparov/Desktop/MVP2/frontend/src/components/TextbookUpload.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport axios from 'axios';\n\ninterface TextbookUploadProps {\n  onUploadSuccess?: (data: any) => void;\n  onUploadError?: (error: string) => void;\n}\n\nconst TextbookUpload: React.FC<TextbookUploadProps> = ({ \n  onUploadSuccess, \n  onUploadError \n}) => {\n  const [file, setFile] = useState<File | null>(null);\n  const [title, setTitle] = useState('');\n  const [subject, setSubject] = useState('');\n  const [grade, setGrade] = useState('');\n  const [description, setDescription] = useState('');\n  const [uploading, setUploading] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const [error, setError] = useState('');\n  const [success, setSuccess] = useState(false);\n\n  const API_URL = process.env.REACT_APP_API_URL || 'http://localhost:8003';\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files && e.target.files[0]) {\n      setFile(e.target.files[0]);\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!file) {\n      setError('Please select a file to upload');\n      return;\n    }\n\n    const formData = new FormData();\n    formData.append('file', file);\n    formData.append('title', title);\n    formData.append('subject', subject);\n    formData.append('grade', grade);\n    formData.append('description', description);\n\n    setUploading(true);\n    setError('');\n    setSuccess(false);\n    setUploadProgress(0);\n\n    // Check if we should use mock upload (for development)\n    const adminDevMode = localStorage.getItem('admin-dev-token') === 'true';\n    \n    if (adminDevMode) {\n      // Use mock upload if in development mode\n      console.log('Using mock upload in development mode');\n      await handleMockUpload(e);\n      return;\n    }\n\n    try {\n      // First, try with authentication\n      const token = localStorage.getItem('token');\n      const response = await axios.post(`${API_URL}/api/textbooks/upload`, formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data',\n          ...(token ? { Authorization: `Bearer ${token}` } : {})\n        },\n        onUploadProgress: (progressEvent) => {\n          const percentCompleted = Math.round(\n            (progressEvent.loaded * 100) / (progressEvent.total || 100)\n          );\n          setUploadProgress(percentCompleted);\n        },\n      });\n\n      console.log('Upload successful:', response.data);\n      setSuccess(true);\n      setFile(null);\n      setTitle('');\n      setSubject('');\n      setGrade('');\n      setDescription('');\n      \n      if (onUploadSuccess) {\n        onUploadSuccess(response.data);\n      }\n    } catch (primaryError) {\n      console.error('Primary upload attempt failed:', primaryError);\n      \n      // Fallback to test endpoint if available\n      try {\n        const fallbackResponse = await axios.post(`${API_URL}/api/test/textbooks/upload`, formData, {\n          headers: { 'Content-Type': 'multipart/form-data' },\n          onUploadProgress: (progressEvent) => {\n            const percentCompleted = Math.round(\n              (progressEvent.loaded * 100) / (progressEvent.total || 100)\n            );\n            setUploadProgress(percentCompleted);\n          },\n        });\n        \n        console.log('Fallback upload successful:', fallbackResponse.data);\n        setSuccess(true);\n        setFile(null);\n        setTitle('');\n        setSubject('');\n        setGrade('');\n        setDescription('');\n        \n        if (onUploadSuccess) {\n          onUploadSuccess(fallbackResponse.data);\n        }\n      } catch (fallbackError: any) {\n        console.error('All upload attempts failed:', fallbackError);\n        \n        // If all real API attempts failed, try the mock upload as last resort\n        console.log('Using mock upload as fallback after API failures');\n        await handleMockUpload(e);\n        return;\n      }\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  // Mock upload for admin user when backend is unavailable\n  const handleMockUpload = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!file) {\n      setError('Please select a file to upload');\n      return;\n    }\n\n    setUploading(true);\n    setError('');\n    setSuccess(false);\n\n    // Simulate upload progress\n    for (let i = 0; i <= 100; i += 10) {\n      setUploadProgress(i);\n      await new Promise(resolve => setTimeout(resolve, 200));\n    }\n\n    const mockResponse = {\n      id: 'mock-textbook-' + Date.now(),\n      title,\n      subject,\n      grade,\n      description,\n      filename: file.name,\n      uploaded_at: new Date().toISOString(),\n      pages_processed: Math.floor(Math.random() * 100) + 20,\n      status: 'processed'\n    };\n\n    console.log('Mock upload successful:', mockResponse);\n    setSuccess(true);\n    setFile(null);\n    setTitle('');\n    setSubject('');\n    setGrade('');\n    setDescription('');\n    \n    if (onUploadSuccess) {\n      onUploadSuccess(mockResponse);\n    }\n    \n    setUploading(false);\n  };\n\n  // Check if using admin user\n  const isAdminUser = localStorage.getItem('token') === 'admin-dev-token';\n\n  return (\n    <div className=\"bg-white shadow overflow-hidden sm:rounded-lg p-6\">\n      <h2 className=\"text-lg font-medium text-gray-900 mb-4\">Upload Textbook</h2>\n      \n      {error && (\n        <div className=\"bg-red-50 border-l-4 border-red-400 p-4 mb-4\">\n          <div className=\"flex\">\n            <div className=\"flex-shrink-0\">\n              <svg className=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\n              </svg>\n            </div>\n            <div className=\"ml-3\">\n              <p className=\"text-sm text-red-700\">{error}</p>\n            </div>\n          </div>\n        </div>\n      )}\n      \n      {success && (\n        <div className=\"bg-green-50 border-l-4 border-green-400 p-4 mb-4\">\n          <div className=\"flex\">\n            <div className=\"flex-shrink-0\">\n              <svg className=\"h-5 w-5 text-green-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n              </svg>\n            </div>\n            <div className=\"ml-3\">\n              <p className=\"text-sm text-green-700\">\n                Textbook successfully uploaded and being processed!\n              </p>\n            </div>\n          </div>\n        </div>\n      )}\n      \n      <form onSubmit={isAdminUser ? handleMockUpload : handleSubmit}>\n        <div className=\"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6\">\n          <div className=\"sm:col-span-6\">\n            <label htmlFor=\"title\" className=\"block text-sm font-medium text-gray-700\">\n              Title\n            </label>\n            <div className=\"mt-1\">\n              <input\n                type=\"text\"\n                id=\"title\"\n                value={title}\n                onChange={(e) => setTitle(e.target.value)}\n                required\n                className=\"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md\"\n              />\n            </div>\n          </div>\n\n          <div className=\"sm:col-span-3\">\n            <label htmlFor=\"subject\" className=\"block text-sm font-medium text-gray-700\">\n              Subject\n            </label>\n            <div className=\"mt-1\">\n              <input\n                type=\"text\"\n                id=\"subject\"\n                value={subject}\n                onChange={(e) => setSubject(e.target.value)}\n                required\n                className=\"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md\"\n              />\n            </div>\n          </div>\n\n          <div className=\"sm:col-span-3\">\n            <label htmlFor=\"grade\" className=\"block text-sm font-medium text-gray-700\">\n              Grade/Level\n            </label>\n            <div className=\"mt-1\">\n              <input\n                type=\"text\"\n                id=\"grade\"\n                value={grade}\n                onChange={(e) => setGrade(e.target.value)}\n                required\n                className=\"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md\"\n              />\n            </div>\n          </div>\n\n          <div className=\"sm:col-span-6\">\n            <label htmlFor=\"description\" className=\"block text-sm font-medium text-gray-700\">\n              Description\n            </label>\n            <div className=\"mt-1\">\n              <textarea\n                id=\"description\"\n                rows={3}\n                value={description}\n                onChange={(e) => setDescription(e.target.value)}\n                className=\"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md\"\n              />\n            </div>\n          </div>\n\n          <div className=\"sm:col-span-6\">\n            <label htmlFor=\"file\" className=\"block text-sm font-medium text-gray-700\">\n              Textbook File (PDF, DOCX, TXT)\n            </label>\n            <div className=\"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md\">\n              <div className=\"space-y-1 text-center\">\n                <svg\n                  className=\"mx-auto h-12 w-12 text-gray-400\"\n                  stroke=\"currentColor\"\n                  fill=\"none\"\n                  viewBox=\"0 0 48 48\"\n                >\n                  <path\n                    d=\"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02\"\n                    strokeWidth={2}\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                  />\n                </svg>\n                <div className=\"flex text-sm text-gray-600\">\n                  <label\n                    htmlFor=\"file-upload\"\n                    className=\"relative cursor-pointer bg-white rounded-md font-medium text-primary-600 hover:text-primary-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-primary-500\"\n                  >\n                    <span>Upload a file</span>\n                    <input\n                      id=\"file-upload\"\n                      name=\"file-upload\"\n                      type=\"file\"\n                      className=\"sr-only\"\n                      accept=\".pdf,.docx,.doc,.txt\"\n                      onChange={handleFileChange}\n                    />\n                  </label>\n                  <p className=\"pl-1\">or drag and drop</p>\n                </div>\n                <p className=\"text-xs text-gray-500\">PDF, DOCX, or TXT up to 50MB</p>\n                {file && (\n                  <p className=\"text-sm text-primary-600 mt-2\">\n                    Selected: {file.name} ({(file.size / 1024 / 1024).toFixed(2)} MB)\n                  </p>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {uploading && (\n          <div className=\"mt-4\">\n            <div className=\"relative pt-1\">\n              <div className=\"flex mb-2 items-center justify-between\">\n                <div>\n                  <span className=\"text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-primary-600 bg-primary-200\">\n                    Uploading\n                  </span>\n                </div>\n                <div className=\"text-right\">\n                  <span className=\"text-xs font-semibold inline-block text-primary-600\">\n                    {uploadProgress}%\n                  </span>\n                </div>\n              </div>\n              <div className=\"overflow-hidden h-2 mb-4 text-xs flex rounded bg-primary-200\">\n                <div\n                  style={{ width: `${uploadProgress}%` }}\n                  className=\"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-primary-500 transition-all duration-300\"\n                ></div>\n              </div>\n            </div>\n          </div>\n        )}\n\n        <div className=\"pt-5\">\n          <div className=\"flex justify-end\">\n            <button\n              type=\"button\"\n              onClick={() => {\n                setFile(null);\n                setTitle('');\n                setSubject('');\n                setGrade('');\n                setDescription('');\n                setError('');\n                setSuccess(false);\n              }}\n              className=\"bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\"\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              disabled={uploading}\n              className={`ml-3 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 ${\n                uploading ? 'opacity-70 cursor-not-allowed' : ''\n              }`}\n            >\n              {uploading ? 'Uploading...' : 'Upload'}\n            </button>\n          </div>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default TextbookUpload;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}